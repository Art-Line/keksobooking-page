{"version":3,"sources":["webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/photo.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/main.js"],"names":["removeChildElements","item","firstChild","removeChild","main","document","querySelector","successTemplate","content","errorTemplate","buttonClose","popup","button","modal","cloneNode","style","zIndex","appendChild","onPopupEscKeydown","evt","key","isEscEvent","preventDefault","closeUserModal","onModalClick","classList","add","removeEventListener","addEventListener","FILTER_DEFAULT_VALUE","filterForm","filterFormElements","Array","from","children","housingType","housingPrice","housingRooms","housingGuests","housingFeatures","filterPriceData","low","min","max","middle","high","Number","MAX_SAFE_INTEGER","forEach","disabled","filterAds","offer","type","value","filterByTypes","rooms","parseInt","filterByRooms","guests","filterByGuests","price","filterByPrice","querySelectorAll","every","elem","features","includes","filterByFeatures","propertyToTypesMap","bungalow","flat","house","palace","cardTemplate","addTextContent","place","objField","text","textContent","DEFAULT_LAT","DEFAULT_LNG","centeredPin","size","map","L","setAddress","address","mainPin","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","mainMarker","marker","lat","lng","draggable","addTo","on","currentCoordinates","target","getLatLng","currentCoordinatesLat","toFixed","currentCoordinatesLng","setMainMarker","resetMainMarker","setLatLng","update","setView","closePopup","layerMarkers","layerGroup","renderPinsOnMap","adverts","remove","pinIcon","slice","location","bindPopup","obj","cardTemplateClone","title","description","src","addAvatar","author","avatar","addType","objItem","createElem","insertAdjacentHTML","addFeatures","objRooms","objGuests","lastSymbol","toString","penultSymbol","lastTwoSymbols","summaSymbols","textRoom","addCapacity","checkin","checkout","addTime","addPhotos","photos","createCard","keepInView","updatePinsOnMap","clearLayers","filteredAdverts","filter","FILE_TYPES","fileAvatarChooser","previewAvatarContainer","filePhotoAdsChooser","previewPhotoAdsContainer","uploadImages","fileChooser","previewContainer","file","files","fileName","name","toLowerCase","some","endsWith","reader","FileReader","previewImg","createElement","setAttribute","result","readAsDataURL","resetAvatarImg","resetPhotoAdsImg","typeToPriceMap","formElements","timeIn","timeOut","roomNumber","capacity","buttonReset","validatePrice","validateRoomNumber","options","onSuccess","onFail","valueLength","length","setCustomValidity","reportValidity","validateTitle","readOnly","body","reset","FormData","fetch","method","then","response","ok","catch","tileLayer","attribution","ads","cb","_","debounce","setFilterChange","message","alertContainer","position","left","top","right","padding","fontSize","textAlign","backgroundColor","append","setTimeout","showAlert","json","data"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const GET_URL = 'https://22.javascript.pages.academy/keksobooking/data';\nconst POST_URL = 'https://22.javascript.pages.academy/keksobooking';\n\nconst getData = (onSuccess, onFail) => {\n  fetch(GET_URL)\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      } else {\n        onFail();\n      }\n    })\n    .then((data) => {\n      onSuccess(data);\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch(\n    POST_URL,\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n      } else {\n        onFail();\n      }\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nexport { getData, sendData };\n","const ALERT_SHOW_TIME = 5000;\n\nconst getRandomFloat = (min, max, decimal) => {\n  if (max > min && min >= 0) {\n    return (Math.random() * (max - min) + min).toFixed(decimal);\n  }\n  throw new Error('Input data error');\n};\n\nconst getRandom = (min, max) => getRandomFloat(min, max, 0);\n\nconst getRandomArrayElement = (array) => array[getRandom(0, array.length - 1)];\n\nconst getRandomArrayLength = (array) => array.slice(Math.floor(Math.random() * (array.length)));\n\nconst removeChildElements = (item) => {\n  while (item.firstChild) {\n    item.removeChild(item.firstChild);\n  }\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\nconst showAlert = (message) => {\n  const alertContainer = document.createElement('div');\n  alertContainer.style.zIndex = 100;\n  alertContainer.style.position = 'absolute';\n  alertContainer.style.left = 0;\n  alertContainer.style.top = 0;\n  alertContainer.style.right = 0;\n  alertContainer.style.padding = '10px 3px';\n  alertContainer.style.fontSize = '30px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.backgroundColor = 'red';\n  alertContainer.textContent = message;\n  document.body.append(alertContainer);\n  setTimeout(() => {\n    alertContainer.remove();\n  }, ALERT_SHOW_TIME);\n};\n\nexport { getRandomFloat, getRandom, getRandomArrayElement, getRandomArrayLength, removeChildElements, isEscEvent, showAlert }\n","import { isEscEvent } from './util.js';\n\nconst main = document.querySelector('main');\nconst successTemplate = document.querySelector('#success').content.querySelector('.success');\nconst errorTemplate = document.querySelector('#error').content.querySelector('.error');\nconst buttonClose = document.querySelector('.error__button');\n\nconst popup = (item, button) => {\n\n  const modal = item.cloneNode(true);\n  modal.style.zIndex = 9999;\n  main.appendChild(modal);\n\n  const onPopupEscKeydown = (evt) => {\n    if (isEscEvent(evt)) {\n      evt.preventDefault();\n      closeUserModal();\n    }\n  };\n\n  const onModalClick = () => closeUserModal();\n\n  const closeUserModal = () => {\n    modal.classList.add('hidden');\n    if (button) {\n      button.removeEventListener('click', onModalClick);\n    }\n    modal.removeEventListener('click', onModalClick);\n    document.removeEventListener('keydown', onPopupEscKeydown);\n  };\n\n  if (button) {\n    buttonClose.addEventListener('click', onModalClick);\n  }\n  modal.addEventListener('click', onModalClick);\n  document.addEventListener('keydown', onPopupEscKeydown);\n\n};\n\nconst successPopup = () => popup(successTemplate);\nconst errorPopup = () => popup(errorTemplate, buttonClose);\n\nexport { successPopup, errorPopup }\n","const FILTER_DEFAULT_VALUE = 'any';\n\nconst filterForm = document.querySelector('.map__filters');\nconst filterFormElements = Array.from(filterForm.children);\nconst housingType = document.querySelector('#housing-type');\nconst housingPrice = document.querySelector('#housing-price');\nconst housingRooms = document.querySelector('#housing-rooms');\nconst housingGuests = document.querySelector('#housing-guests');\nconst housingFeatures = document.querySelector('#housing-features');\n\nconst filterPriceData = {\n  low: {\n    min: 0,\n    max: 10000,\n  },\n  middle: {\n    min: 10000,\n    max: 50000,\n  },\n  high: {\n    min: 50000,\n    max: Number.MAX_SAFE_INTEGER,\n  },\n};\n\nconst disableFilter = () => {\n  filterForm.classList.add('map__filters--disabled');\n  filterFormElements.forEach((item) => {\n    item.disabled = true;\n  });\n};\n\ndisableFilter();\n\nconst enableFilter = () => {\n  filterForm.classList.remove('map__filters--disabled');\n  filterFormElements.forEach((item) => {\n    item.disabled = false;\n  });\n};\n\nconst setFilterChange = (cb) => {\n  filterForm.addEventListener('change', () => {\n    cb();\n  });\n};\n\nconst setFilterReset = (cb) => {\n  filterForm.addEventListener('reset', () => {\n    cb();\n  });\n};\n\nconst filterByTypes = (item) => {\n  if (item.offer.type === housingType.value || housingType.value === FILTER_DEFAULT_VALUE) {\n    return item;\n  }\n};\n\nconst filterByRooms = (item) => {\n  if (item.offer.rooms === parseInt(housingRooms.value) || housingRooms.value === FILTER_DEFAULT_VALUE) {\n    return item;\n  }\n};\n\nconst filterByGuests = (item) => {\n  if (item.offer.guests === parseInt(housingGuests.value) || housingGuests.value === FILTER_DEFAULT_VALUE) {\n    return item;\n  }\n};\n\nconst filterByPrice = (item) => {\n  if (housingPrice.value === FILTER_DEFAULT_VALUE) {\n    return item;\n  } else {\n    if (item.offer.price > filterPriceData[housingPrice.value].min && item.offer.price <= filterPriceData[housingPrice.value].max) {\n      return item;\n    }\n  }\n};\n\nconst filterByFeatures = (item) => {\n  const housingFeaturesChecked = Array.from(housingFeatures.querySelectorAll('input:checked'));\n  return housingFeaturesChecked.every((elem) => {\n    return item.offer.features.includes(elem.value)\n  });\n};\n\nconst filterAds = (item) => {\n  return filterByTypes(item) && filterByRooms(item) && filterByGuests(item) && filterByPrice(item) && filterByFeatures(item);\n};\n\nexport { enableFilter, setFilterChange, filterAds, filterForm, setFilterReset }\n","import { removeChildElements } from './util.js';\n\nconst NUMBER_ONE = 1;\nconst NUMBER_TWO = 2;\nconst NUMBER_FOUR = 4;\nconst NUMBER_TEN = 10;\nconst NUMBER_TWENTY = 20;\n\nconst propertyToTypesMap = {\n  bungalow: 'Бунгало',\n  flat: 'Квартира',\n  house: 'Дом',\n  palace: 'Дворец',\n};\nconst cardTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst addTextContent = (place, elem, objField, text) => {\n  const item = place.querySelector(elem);\n  if (objField) {\n    if (text) {\n      return item.textContent = objField + text;\n    }\n    return item.textContent = objField;\n  }\n  return place.removeChild(item);\n};\n\nconst addAvatar = (place, elem, objField) => {\n  const item = place.querySelector(elem);\n  if (objField) {\n    return item.src = objField;\n  }\n  return place.removeChild(item);\n};\n\nconst addType = (place, elem, objField) => {\n  const item = place.querySelector(elem);\n  if (objField) {\n    return item.textContent = propertyToTypesMap[objField];\n  }\n  return place.removeChild(item);\n};\n\nconst addFeatures = (place, elem, objField) => {\n  const item = place.querySelector(elem);\n  if (objField) {\n    removeChildElements(item);\n    objField.forEach((objItem) => {\n      const createElem = `<li class=\"popup__feature popup__feature--${objItem}\"></li>`\n      item.insertAdjacentHTML('beforeend', createElem);\n    });\n    return;\n  }\n  return place.removeChild(item);\n};\n\nconst addPhotos = (place, elem, objField) => {\n  const item = place.querySelector(elem);\n  if (objField) {\n    removeChildElements(item);\n    objField.forEach((objItem) => {\n      const createElem = `<img src=\"${objItem}\" class=\"popup__photo\" width=\"45\" height=\"40\" alt=\"Фотография жилья\">`\n      item.insertAdjacentHTML('beforeend', createElem);\n    });\n    return;\n  }\n  return place.removeChild(item);\n};\n\nconst addTime = (place, elem, checkin, checkout) => {\n  const item = place.querySelector(elem);\n  if (checkin && checkout) {\n    return item.textContent = `Заезд после ${checkin}, выезд до ${checkout}`;\n  } else if (checkin) {\n    return item.textContent = `Заезд после ${checkin}`;\n  } else if (checkout) {\n    return item.textContent = `Выезд до ${checkout}`;\n  }\n  return place.removeChild(item);\n};\n\nconst addCapacity = (place, elem, objRooms, objGuests) => {\n  const item = place.querySelector(elem);\n  const lastSymbol = parseInt(objRooms.toString().slice(-1));\n  const penultSymbol = parseInt(objRooms.toString().slice(-2, -1));\n  const lastTwoSymbols = parseInt(objRooms.toString().slice(-2));\n  let summaSymbols = 0;\n  if (penultSymbol) {\n    summaSymbols = lastSymbol + penultSymbol;\n  }\n  let textRoom = 'комнат';\n  if (lastSymbol === NUMBER_ONE && summaSymbols !== NUMBER_TWO) {\n    textRoom = 'комната';\n  } else if (lastSymbol >= NUMBER_TWO && lastSymbol <= NUMBER_FOUR && !(lastTwoSymbols >= NUMBER_TEN && lastTwoSymbols <= NUMBER_TWENTY)) {\n    textRoom = 'комнаты';\n  }\n  if (objRooms && objGuests) {\n    return item.textContent = `${objRooms} ${textRoom} для ${objGuests} гостей`;\n  } else if (objRooms) {\n    return item.textContent = `${objRooms} ${textRoom}`;\n  } else if (objGuests) {\n    return item.textContent = `Для ${objGuests} гостей`;\n  }\n  return place.removeChild(item);\n};\n\nconst createCard = (obj) => {\n  const cardTemplateClone = cardTemplate.cloneNode(true);\n  addTextContent(cardTemplateClone, '.popup__title', obj.offer.title);\n  addTextContent(cardTemplateClone, '.popup__text--address', obj.offer.address);\n  addTextContent(cardTemplateClone, '.popup__description', obj.offer.description);\n  addTextContent(cardTemplateClone, '.popup__text--price', obj.offer.price, ' ₽/ночь');\n  addAvatar(cardTemplateClone, '.popup__avatar', obj.author.avatar);\n  addType(cardTemplateClone, '.popup__type', obj.offer.type);\n  addFeatures(cardTemplateClone, '.popup__features', obj.offer.features);\n  addCapacity(cardTemplateClone, '.popup__text--capacity', obj.offer.rooms, obj.offer.guests);\n  addTime(cardTemplateClone, '.popup__text--time', obj.offer.checkin, obj.offer.checkout);\n  addPhotos(cardTemplateClone, '.popup__photos', obj.offer.photos);\n  return cardTemplateClone;\n};\n\nexport { createCard }\n","/* global L:readonly */\nimport { address, enableForm } from './form.js';\nimport { enableFilter, filterAds } from './filter.js';\nimport { createCard } from './card.js';\n\nconst DEFAULT_LAT = 35.6817;\nconst DEFAULT_LNG = 139.75388;\nconst DEFAULT_SCALE = 9;\nconst PIN_SIZE = 40;\nconst MAIN_PIN_SIZE = 52;\nconst VISIBLE_ADS = 10;\nconst PIN_IMG = './img/pin.svg';\nconst MAIN_PIN_IMG = './img/main-pin.svg';\n\nconst centeredPin = (size) => size / 2;\nconst map = L.map('map-canvas');\n\nconst setAddress = () => {\n  address.value = `${DEFAULT_LAT}, ${DEFAULT_LNG}`;\n};\n\nconst mapLoad = () => {\n  map.on('load', () => {\n    enableForm();\n    setAddress();\n  })\n    .setView({\n      lat: DEFAULT_LAT,\n      lng: DEFAULT_LNG,\n    }, DEFAULT_SCALE);\n\n  L.tileLayer(\n    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n    {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n    },\n  ).addTo(map);\n};\n\nconst setMainMarker = () => {\n\n  const mainPinIcon = L.icon({\n    iconUrl: MAIN_PIN_IMG,\n    iconSize: [MAIN_PIN_SIZE, MAIN_PIN_SIZE],\n    iconAnchor: [centeredPin(MAIN_PIN_SIZE), MAIN_PIN_SIZE],\n  });\n\n  const mainMarker = L.marker(\n    {\n      lat: DEFAULT_LAT,\n      lng: DEFAULT_LNG,\n    },\n    {\n      draggable: true,\n      icon: mainPinIcon,\n    },\n  );\n\n  mainMarker.addTo(map);\n\n  mainMarker.on('moveend', (evt) => {\n    const currentCoordinates = evt.target.getLatLng();\n    const currentCoordinatesLat = currentCoordinates.lat.toFixed(5);\n    const currentCoordinatesLng = currentCoordinates.lng.toFixed(5);\n    address.value = `${currentCoordinatesLat}, ${currentCoordinatesLng}`;\n  });\n\n  return mainMarker;\n\n};\n\nconst mainPin = setMainMarker();\n\nconst resetMainMarker = () => {\n  mainPin.setLatLng([DEFAULT_LAT, DEFAULT_LNG]).update();\n  map.setView({\n    lat: DEFAULT_LAT,\n    lng: DEFAULT_LNG,\n  }, DEFAULT_SCALE);\n  map.closePopup();\n};\n\nconst layerMarkers = L.layerGroup().addTo(map);\n\nconst renderPinsOnMap = (adverts) => {\n  enableFilter();\n  const pinIcon = L.icon({\n    iconUrl: PIN_IMG,\n    iconSize: [PIN_SIZE, PIN_SIZE],\n    iconAnchor: [centeredPin(PIN_SIZE), PIN_SIZE],\n  });\n  adverts\n    .slice(0, VISIBLE_ADS)\n    .forEach((item) => {\n      let marker = L.marker(\n        {\n          lat: item.location.lat,\n          lng: item.location.lng,\n        },\n        {\n          icon: pinIcon,\n        },\n      );\n      marker\n        .addTo(layerMarkers)\n        .bindPopup(\n          createCard(item),\n          {\n            keepInView: true,\n          },\n        );\n    });\n};\n\nconst updatePinsOnMap = (adverts) => {\n  layerMarkers.clearLayers();\n  const filteredAdverts = adverts.filter(filterAds);\n  renderPinsOnMap(filteredAdverts);\n};\n\nexport { renderPinsOnMap, mapLoad, setAddress, setMainMarker, resetMainMarker, updatePinsOnMap }\n","import { removeChildElements } from './util.js';\n\nconst FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\nconst IMG_WIDTH = 40;\nconst IMG_HEIGHT = 40;\nconst DEFAULT_AVATAR_IMG = './img/muffin-grey.svg';\n\nconst fileAvatarChooser = document.querySelector('.ad-form-header__input');\nconst previewAvatarContainer = document.querySelector('.ad-form-header__preview');\nconst filePhotoAdsChooser = document.querySelector('.ad-form__input');\nconst previewPhotoAdsContainer = document.querySelector('.ad-form__photo');\n\nconst uploadImages = (fileChooser, previewContainer) => {\n\n  fileChooser.addEventListener('change', () => {\n\n    const file = fileChooser.files[0];\n    const fileName = file.name.toLowerCase();\n    const matches = FILE_TYPES.some((item) => {\n      return fileName.endsWith(item);\n    });\n\n    if (matches) {\n\n      const reader = new FileReader();\n      let previewImg = previewContainer.querySelector('.ad-form-header__preview img');\n\n      if (previewImg === null) {\n        previewImg = document.createElement('img');\n        previewImg.setAttribute('width', IMG_WIDTH);\n        previewImg.setAttribute('height', IMG_HEIGHT);\n        previewContainer.appendChild(previewImg);\n      }\n\n      reader.addEventListener('load', () => {\n        previewImg.src = reader.result;\n      });\n\n      reader.readAsDataURL(file);\n\n    }\n\n  });\n\n};\n\nuploadImages(fileAvatarChooser, previewAvatarContainer);\nuploadImages(filePhotoAdsChooser, previewPhotoAdsContainer);\n\nconst resetAvatarImg = () => {\n  let previewAvatarImg = previewAvatarContainer.querySelector('.ad-form-header__preview img');\n  previewAvatarImg.src = DEFAULT_AVATAR_IMG;\n}\n\nconst resetPhotoAdsImg = () => {\n  removeChildElements(previewPhotoAdsContainer);\n}\n\nexport { resetAvatarImg, resetPhotoAdsImg };\n","import { sendData } from './api.js';\nimport { successPopup, errorPopup } from './popup.js';\nimport { setAddress, resetMainMarker } from './map.js';\nimport { resetAvatarImg, resetPhotoAdsImg } from './photo.js';\nimport { filterForm } from './filter.js';\n\nconst MAX_PRICE = 1000000;\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\nconst MAX_ROOMS_NUMBER = 100;\nconst typeToPriceMap = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n};\n\nconst form = document.querySelector('.ad-form');\nconst formElements = Array.from(form.children);\nconst title = form.querySelector('#title');\nconst address = form.querySelector('#address');\nconst type = form.querySelector('#type');\nconst price = form.querySelector('#price');\nconst timeIn = form.querySelector('#timein');\nconst timeOut = form.querySelector('#timeout');\nconst roomNumber = form.querySelector('#room_number');\nconst capacity = form.querySelector('#capacity');\nconst buttonReset = form.querySelector('.ad-form__reset');\n\nconst disableForm = () => {\n  form.classList.add('ad-form--disabled');\n  formElements.forEach((item) => {\n    item.disabled = true;\n  });\n};\n\nconst enableForm = () => {\n  form.classList.remove('ad-form--disabled');\n  formElements.forEach((item) => {\n    item.disabled = false;\n  });\n};\n\nconst validatePrice = () => {\n  price.setAttribute('placeholder', typeToPriceMap[type.value]);\n  price.setAttribute('min', typeToPriceMap[type.value]);\n  price.setAttribute('max', MAX_PRICE);\n};\n\nconst validateTimeIn = () => {\n  timeOut.value = timeIn.value;\n};\n\nconst validateTimeOut = () => {\n  timeIn.value = timeOut.value;\n};\n\nconst validateTitle = (item) => {\n  const valueLength = item.value.length;\n  if (valueLength < MIN_TITLE_LENGTH) {\n    item.setCustomValidity('Ещё ' + (MIN_TITLE_LENGTH - valueLength) + ' симв.');\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    item.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) + ' симв.');\n  } else {\n    item.setCustomValidity('');\n  }\n  item.reportValidity();\n};\n\nconst validateRoomNumber = () => {\n  if (parseInt(roomNumber.value) === MAX_ROOMS_NUMBER) {\n    capacity.value = 0;\n    Array.from(capacity.options).forEach(item => {\n      item.disabled = parseInt(roomNumber.value) > parseInt(item.value) && parseInt(item.value) !== 0;\n    });\n  } else {\n    capacity.value = roomNumber.value;\n    Array.from(capacity.options).forEach(item => {\n      item.disabled = parseInt(roomNumber.value) < parseInt(item.value) || parseInt(item.value) === 0;\n    });\n  }\n};\n\ntype.addEventListener('change', () => validatePrice());\ntimeIn.addEventListener('change', () => validateTimeIn());\ntimeOut.addEventListener('change', () => validateTimeOut());\ntitle.addEventListener('input', () => validateTitle(title));\nroomNumber.addEventListener('change', () => validateRoomNumber());\n\nconst setAdFormSubmit = () => {\n  form.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n    sendData(\n      () => {\n        successPopup(), form.reset(), filterForm.reset(), resetPhotoAdsImg(), resetAvatarImg(), setAddress(), validatePrice(), validateRoomNumber(), resetMainMarker()\n      },\n      () => errorPopup(),\n      new FormData(evt.target),\n    );\n  });\n};\n\nconst setAdFormReset = () => {\n  buttonReset.addEventListener('click', (evt) => {\n    evt.preventDefault();\n    filterForm.reset();\n    form.reset();\n    resetPhotoAdsImg();\n    resetAvatarImg();\n    setAddress();\n    validatePrice();\n    validateRoomNumber();\n    resetMainMarker();\n  })\n};\n\naddress.readOnly = true;\ndisableForm();\nvalidatePrice();\nvalidateRoomNumber();\nsetAdFormSubmit();\nsetAdFormReset();\n\nexport { address, enableForm };\n","/* global _:readonly */\nimport './form.js';\nimport './photo.js';\nimport './filter.js';\nimport { getData } from './api.js';\nimport { mapLoad, renderPinsOnMap, updatePinsOnMap } from './map.js';\nimport { showAlert } from './util.js';\nimport { setFilterChange, setFilterReset } from './filter.js';\n\nconst RERENDER_DELAY = 500;\n\nmapLoad();\n\ngetData(\n  (ads) => {\n    renderPinsOnMap(ads);\n    setFilterReset(_.debounce(\n      () => updatePinsOnMap(ads),\n      RERENDER_DELAY,\n    ));\n    setFilterChange(_.debounce(\n      () => updatePinsOnMap(ads),\n      RERENDER_DELAY,\n    ));\n  },\n  () => showAlert('Ошибка загрузки данных'),\n);\n"],"sourceRoot":""}